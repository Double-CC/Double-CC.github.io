---
layout:     post
title:      "判别式模型和生成式模型"
subtitle:   "lets begin"
date:       2020-04-21
author:     "CT"
header-img: "img/blog-bg.jpg"
tags:
    - 机器学习
---
# 1. 我们要做什么：
- 以分类问题为例：给定数据集$X$、数据标签$C$，学习一个模型。我们的目标是给出新的$x$，判断$x$所属的类别。用数学语言来描述，就是求$p(c|x)$的大小。
# 2. 判别式模型：直接对 $p(c|x)$ 建模
### 2.1 建立一个$x$到$p(c|x)$的映射
- 例如在逻辑回归问题中，我们使用了sigmoid函数来作为映射函数，并设定参数$\theta$：
$$p(c|x)=sigmoid(\theta^Tx)$$
- 再例如在神经网络中，我们使用了神经网络的非线性映射功能作为映射函数，并设定参数矩阵$\Theta$:
![在这里插入图片描述](https://img-blog.csdnimg.cn/20200421104925322.png)
- 再例如在SVM中，我们建模了一个类别分割超平面$y=\omega x+b$，用于从输入$x$到输出$c$的映射（左图），如果是非线性分割，可以使用高斯核，得到一个分割的“超曲面”（右图）：
 ![a](https://img-blog.csdnimg.cn/20200421104844882.png)![b](https://img-blog.csdnimg.cn/20200421105520955.png)
 - 再例如在线性回归中，我们引入的判别式模型可以是$y=\omega_1x_1+\omega_2x_2+b$，也可以是$y=\omega_1x_1^2+\omega_2x_2^2+\omega_3x_1 x_2+b$等等，理论上有无数种判别式模型可以使用，只不过我们选择了那个效果最好的；
 - 再例如决策树模型中，树本身就是一个判别式模型，它的参数就是树的属性划分，学习的过程就是学习如何划分属性。
### 2.2 判别式模型的特征
- 在以上例子中，我们对数据集中 $x$ 和 $c$ 的概率分布并不感兴趣，我们只关注从 $x$ 到 $c$ 的映射模型，无论哪种模型，我们的目标都是找到一个最优的模型参数，使得我们的预测结果最准确。
- 既然牵扯到了寻找最优参数，那就必须要定义**损失函数**，常用的损失函数和使用场景举例：
	- MSE(最小二乘)-线性回归、神经网络等
	- Cross-Entropy(交叉熵损失函数)-逻辑回归、神经网络等
	- hinge(合页损失函数)-SVM
	- 指数损失函数-AdaBoost
### 2.3 判别式模型的使用
- 得到了$p(c|x)$，如何判断x属于哪一个类别：
$$Y=argmax_c(p(c|x))$$
# 3. 生成式模型：使用贝叶斯公式对 $p(c|x)$ 建模
- 贝叶斯公式：
$$p(c|x) = \frac{p(x|c)p(c)}{p(x)}$$
- 由于使用的时候我们只关注$argmax_c(p(c|x))$，分母对于输入变量来说是不变的，因此我们只对分子建模，即对**联合概率分布**建模：
$$p(c|x) \propto p(x,c)=p(x|c)p(c) \tag{3.1}$$
- 该模型完全是由概率得到的，因此不存在人为指定的参数，将向量$x$的各个值代入上式，就可以直接得到向量 $x$ 和所有不同的标签 $c$ 的联合概率分布，进行比较，最大的那个就是 $x$ 对应的预测值。
### 朴素贝叶斯
- 以朴素贝叶斯为例，由于假设特征向量$x$的所有属性都独立（属性条件独立性假设），则公式 $(3.1)$可写为：
$$p(c|x) \propto p(x,c)=p(c)\prod_{i=1}^n p(x_i|c) \tag{3.2}$$
- 给定数据集X和标签C，可以建立**似然估计表**（我自己起的名），即计算所有的：
$$p(x_i|c)\quad for\quad \forall x_i \in A_i,\forall c\in C$$
其中$A_i$表示向量 $x$ 的第 $i$ 个属性的取值集合， $C$表示所有的类别集合 ;
- 给定一个新的数据 $x$，只要根据该数据的各个属性值进行查表，根据式 $(3.2)$ 就可以计算出所有类别的联合概率分布：
$$p(x,c)\quad for\quad\forall c\in C$$
- 然后，和判别式模型一样，使用下式进行最终类别的判断：
$$Y=argmax_c(p(c|x))=argmax_c(p(x,c))$$
# 4. 优缺点
|  | 优点 | 缺点|
|-----|--|------|
| 判别式模型  | 1. 可以清晰的分辨出类型之间的差异特征；2. 适用于多类识别； 3. 模型简单 | 无法反应数据本身的特性|
| 生成式模型 | 1. 研究单类问题更加灵活； 2. 模型可以通过增强学习得到；3. 能用于数据不完整的情况 | 学习和计算过程比较复杂 |
# 5. 模型代表
|判别式模型| 生成式模型 |
|--|--|
|线性回归；逻辑回归 ；支持向量机；神经网络； 邻近取样（Nearest Neighbor ）； 条件随机场（CRF）；提升算法（Boosting）；高斯过程；分类回归树（CART）；最大熵马尔可夫模型（MEMM） | 混合高斯模型（Mixtures of Gaussians）；隐马尔科夫模型（HMM）；贝叶斯网络；马尔科夫随机场； 潜在狄利克雷分配Latent Dirichlet Allocation(LDA)；S型信念网络Sigmoidal Belief Networks；多专家模型Mixtures of Experts ；|